import base64
import json
import os

# This contains the CLEAN secret you shared in chat.
# It works perfectly when not corrupted by Replit.
clean_secret = """ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiZGlzY29yZHNjaGVkdWxlcmJvdCIsCiAgInByaXZhdGVfa2V5X2lkIjogIjhkYWQ3MmY4YmVkMzYxMjRjMzI2OTc0ODFiNjFhMmYyNTU5ODE0NWIiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQ3VpTjdCZVNjeDI5MWZceXlIZUZRQS9ERlJzTEI0RlZMQjl3WnBMSXUvREFSeUhMUmZabUFVb1ZNZVBPTzI3SkY2UWMwSEEyNVRnYUV5aFhcbk5QWmtPdnBkdHdKRTYrR2xKckkrb00vTU5FcGxybHVXeWpqNm9zc3FuK09ESjJhaFdSb3JhczVXS2ZqWmM4RUFcblMwRWFCR2l0UVA3VjB0NTcvZ1ZiaC9zZ21HYkVnVGlPbE43LzhLdktFSkdGalFTdHdraDhvWDBDdTl1THVjZEx6XHhqeS84SHdkM2tpdWJMbHZnSE1IZ3RjTGdHQmtZSEQ2SUYreWlkU2tiZ1BlMWUwTmpSRlcyWDAwV01lNTJHMnhcbjlJc252T2EwVnY4OGE5Qmk6SlkyTDRVdFdJQi81cDBXaW9nVU1xdlEyWW51NjdKQ3Z6ckhkaGJTMVZITSsxVE5cbjYvZzNYRkVEQWdNQkFBRUNHZ0VBVTFKbVBha1FEQjV4bmNOL1E2N2tsM1pnOWEvOGoyUEVFbzMxYnoxQjN4bFdcblNjdTVxTkxld2lXU0lxZCs2U09QSm01ZjArVTBGa2FsRUpUcG44cHNNZ2NuWHkzWkNGWGtLVnR1T0llU0tON0hcblBNS0gxeWVXcEYrMlpxdU50R05zT2VRQVkyUWdOL2VwNFBFTVFGWndmcDJ6eXZLalkrMmtRN20xWlhNSWUybm9caW1LQW1jeHdzODlsK3FLMlEvdDRwS0pVSWlaY2JVMWMwcmRzaU5xMENLbHd6c0FpWW9Ed0ZDNHNVWGR6YlRlNVxuRE5tZFlxU3IvWDlkZHA3YUw3TFNiK0xqdmhOVzBQQlQxV2dETWpzNlh4RE1MSVM1ZG43NEEvT2d5R20zdmZSaVxuQlJCNHp6eUdCQmRpandvTGdqa3FCYWcyYXdiU0w1K2M3RmxLWnlFSDZRS0JnUURVY0JrMGV5TjRrV0VoZzNHMVxuY1VTRC8xbzBUbTZoNEEvT2d5R20zdmZSaVxuQlJCNHp6eUdCQmRpandvTGdqa3FCYWcyYXdiU0w1K2M3RmxLWnlFSDZRS0JnUURVY0JrMGV5TjRrV0VoZzNHMVxuY1VTRC8xbzBUbTZoNEEvT2d5R20zdmZSaVxuQlJCNHp6eUdCQmRpandvTGdqa3FCYWcyYXdiU0w1K2M3RmxLWnlFSDZRS0JnUURVY0JrMGV5TjRrV0VoZzNHMVxuY1VTRC8xbzBUbTZoNEEvN0hoMVhsT0VoZ0RUN24rNTcrV2JEbTA2UG8vK3ZFREtUSURZbVplM29aT2luc3lmVFxuMVV1VFRlV2hKNE90cGF4RnNMLzdGNStrR3dNSXFBaFlCTkRYT2l4VkxrQWkvOTJRUDZFUkZra09FTFJ6MXF0VFxuWndJeFVhemhtcXcyZ2J6RjlzbGtHd0VUUndLQmdRRFNVd3U3VG9UN0VrRnVRRmJ6NEdCTUxPNWNWc0l1SUFSTlxuU0daN1JVNlFNTTdnL3ZTVWJ1L2doaFV5eThkaGJFNjZybzlDVnE1WUgxSVU4WmRjaUpmRXdkQVpCRTVJWlljdFxubkp6OUdUT05VVUd2dmx4TmVYRGlIYWNoWmgxVXBBK2c0TisrE0SzZDWEvNERkStbE15bnJMeUlha2lRM0tka1xudVpSV1hHYVplUUtCZ1FDYWREcFBKdXgrUDYwUU1jSmR1bEduYXVRSnZiREFMdWxQbWZDWmR4SmdDNkc3RjMzXG5jemhkSkJEenpMZ2NiemxtTVBoTjZMQVYwREE3cFkxaWZYQ1Z0QUF0c0U0VDFhMktcYmNiZDJ5Ull6Wk1kK2RCXH5INWJlcEtRUTlvU1pMdERJalFxdElyZlE2eUpZU283Y0NIMnBwZng5TnZqWTFIRU11Y1pvNngxWUJ3S0JnR3paXG5GOEEzTWJFeVVIUjdqY1NuQVk5T3pZMHlSWXBUdlZZMWl2d084VXJFUjd5L2xkcGYwM3NTU1ZSQmpBMEtYWEhqXG5MamI1M3o2eDd1dng0QkMrakRVQ3pPeTFnc0lLOFR1VXl0WmR2WVZNWVQ5UHVEdE1OelIrZmlsVnpLWXFSZ0JQXG5nTndmQjkvb3VuUzB5cFJCOCs4dkJCOGhTZTdXa3pjWXFBSFFQdkxWQW9HQkFJUWw5Y21rNmN5TzdhQ2E1bVI0XG5xTTZ5T2FpU1ZSUFdWaWlVYk8vWnNoOGdqaFp0WG5jR2F6NWZBRjFoQkloaWR2NlU0SkRVUWR0SnRUdXhPRVc3XG55Nmh1VXBjbzJnVVlwVzArZlJML2kvRDlWZ1c5VVNzSkJ3bFJaTE9aT3U2YXBGbWhVS0NlK2lzb0k1czhCZnRnXG5VZW5ZdmhCeWlqMmdLMEJiUW1KSyt4NGdcbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsCiAgImNsaWVudF9lbWFpbCI6ICJkaXNjb3JkLWJvdC1hY2Nlc3NAZGlzY29yZHNjaGVkdWxlcmJvdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICIxMDk4MjgzMDUyMzI2MTAyMjU4OTEiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20sby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2Rpc2NvcmQtYm90LWFjY2VzcSU0MGlzY29yZHNjaGVkdWxlcmJvdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgInVuaXZlcnNlX2RvbWFpbiI6ICJnb29nbGVhcGlzLmNvbSIKfQ=="""

# Clean it
base64_secret = "".join(clean_secret.split())

print("Attempting to restore credentials...")

try:
    decoded_bytes = base64.b64decode(base64_secret, validate=True)
    decoded_str = decoded_bytes.decode('utf-8')
    
    # Validate JSON
    try:
        json_obj = json.loads(decoded_str)
        print("SUCCESS: Decoded valid JSON credentials!")
        
        with open("credentials.json", "w") as f:
            f.write(decoded_str)
        print("SUCCESS: Saved to credentials.json")
    except Exception as e:
        print(f"ERROR: Decoded string was not valid JSON: {e}")
except Exception as e:
    print(f"ERROR: Decoding failed: {e}")
